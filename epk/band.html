<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Atomic Fruit</title>
    <style>
@font-face {
  font-family: 'Matrix';
  src: url('./LcdSolid-VPzB.ttf') format('truetype'),
  /* Add additional font formats if needed */
}

      
   body {
    margin: 0;
     }

      #menu {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: #333; /* Dark background color */
        padding: 10px;
        box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        z-index: 1000;
      }

      #menu a {
        color: #fff; /* White text color */
        text-decoration: none;
        margin: 0 10px;
        font-size: 16px;
        cursor: pointer;
      }

      #menu a:hover {
        text-decoration: underline;
      }

  .arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    cursor: pointer;
    outline: none;
  }

  #leftArrow {
    left: 5%;
    transform: translateX(-50%);
    background: url('left.png') no-repeat center center;
    background-size: cover;
    color: green;
    width: 50px;
    height: 50px;
  }

  #rightArrow {
    right: 5%;
    transform: translateX(50%);
    background: url('right.png') no-repeat center center;
    background-size: cover;
    color: green;
    width: 50px;
    height: 50px;
  }
  .matrix-text {
    position: absolute;
    font-family: 'Matrix', sans-serif;
    color: #00FF00; /* Green color */
    font-size: 20px;
  }

  #textNearObject {
    left: 20%; /* Adjust the left positioning as needed */
    top: 20%; /* Adjust the top positioning as needed */
  }
    </style>
  </head>
  <body>
    <!-- <div id="menu"> -->
    <!--   <a href="#" onclick="">About</a> -->
    <!--   <a href="#" onclick="">Live</a> -->
    <!--   <a href="#" onclick="">Listen</a> -->
    <!--   <a href="#" onclick="">Merch</a> -->
    <!--   <a href="#" onclick="">Band</a> -->
    <!--   <\!-- Add more menu items as needed -\-> -->
    <!-- </div> -->

    <div class="matrix-text" id="textNearObject"></div>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@v0.161.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@v0.161.0/examples/jsm/"
         }
      }
    </script>
    <script type="module">
      import * as THREE from 'three';
      import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

      const bgcolor = new THREE.Color( 0x202020 );
      var scene = new THREE.Scene();
      scene.background = bgcolor;
      var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      var renderer = new THREE.WebGLRenderer();

      var descriptions = {
        "raf_low_poly": ["Player: Raf", "Weapon: Guitar", "Warning! VERY LOUD!", "Special ability: Brain hemorrage"],
        "fede_low_poly": ["Player: Fede", "Weapon: Drums", "Very FAST"],
        "marti_low_poly": ["Player: Martin", "Weapon: Synthesizer", "Mumbles a lot... What is he saying?"],
        "fardi_low_poly": ["Player: Farhad", "Weapon: Microcosm", "Special ability: hang on, let me do the Johnny Greenwood thing"]
      }

     var sizes = {
          "raf_low_poly": 1,
          "fede_low_poly": 1.6,
          "marti_low_poly": 1.5,
        "fardi_low_poly": 1.2
      }

      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);
      var models = ['./raf_low_poly.glb', './marti_low_poly.glb', './fede_low_poly.glb', 'fardi_low_poly.glb']; // Add paths to your models
      var currentModelIndex = 0;
      var model;

      // Load initial model
      loadModel(models[currentModelIndex]).then(() => {
        // Add arrows
        var leftArrow = createArrow('leftArrow');
        var rightArrow = createArrow('rightArrow');

        leftArrow.addEventListener('click', function () {
          changeModel(-1);
        });

        rightArrow.addEventListener('click', function () {
          changeModel(1);
        });

        document.body.appendChild(leftArrow);
        document.body.appendChild(rightArrow);

        // Add Matrix-style text
        var textNearObject = createMatrixText('textNearObject');
        document.body.appendChild(textNearObject);

        // Add a directional light
        var light = new THREE.DirectionalLight(0xffffff);
        light.position.set(1, 1, 1).normalize();
        var alight = new THREE.AmbientLight(0xffa0ff);
        scene.add(light);  
        scene.add(alight);

        camera.position.z = 5;

        var animate = function () {
          requestAnimationFrame(animate);

          // Add rotation or any other animation logic here
          // Example: model.rotation.x += 1.01;
          if (model) {
            model.rotation.y += 0.01;
          }

          renderer.render(scene, camera);
        };

        animate();
      });

      function loadModel(modelPath) {
        return new Promise((resolve) => {
	  scene.remove(model);
          var loader = new GLTFLoader();
          loader.load(modelPath, function (gltf) {
            model = gltf.scene;
	    var modelName = modelPath.split('/').pop().split('.')[0];
            model.scale.set(sizes[modelName], sizes[modelName], sizes[modelName]);
            scene.add(model);
            document.getElementById('textNearObject').innerText = descriptions[modelName].join('^');
            clearTimeout(timeoutId);
            unveilText();
            resolve();
          });
        });
      }

      let timeoutId;

      function unveilText() {
	  const textElement = document.getElementById("textNearObject");
	  const textContent = textElement.innerHTML;
	  textElement.innerHTML = "";
	  let index = 0;
	  function appendNextCharacter() {
	      if (textContent[index] == "^") {
		  textElement.innerHTML += '<br><br>';
	      } else {
		  textElement.innerHTML += textContent[index];
	      }
	      
	      index++;
	      if (index < textContent.length) {
		  timeoutId = setTimeout(appendNextCharacter, 50); // Adjust the delay (100 milliseconds in this example)
	      } else {
		  textElement.classList.remove("hidden");
	      }
	  }
	  appendNextCharacter();
	  
      }

      function createArrow(id) {
        var arrow = document.createElement('div');
        arrow.id = id;
        arrow.className = 'arrow';
        return arrow;
      }

      function createMatrixText(id) {
        var matrixText = document.createElement('div');
        matrixText.id = id;
        matrixText.className = 'matrix-text';
        return matrixText;
      }

      function changeModel(direction) {
        currentModelIndex = (models.length + currentModelIndex + direction) % models.length;
        // Load and add the new model to the scene
        loadModel(models[currentModelIndex]);
      }
    </script>
  </body>
</html>
